import{j as s,g as M,r as y,m as N,a as F,d as V,b as Q}from"./app-BKEzGz0K.js";import{v as L}from"./video.es-D_dj1A59.js";/* empty css                 */import{P as W,S as q,C as G}from"./bootstrap.bundle.min-BluACLJN.js";import{P as R}from"./PrimaryButton-BqlALMXI.js";import{d as J}from"./helper-nczUq3Rf.js";function X({children:e}){return s.jsx(W,{store:q,children:s.jsx(G,{children:e})})}var _={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var o={}.hasOwnProperty;function t(){for(var r="",i=0;i<arguments.length;i++){var h=arguments[i];h&&(r=d(r,l(h)))}return r}function l(r){if(typeof r=="string"||typeof r=="number")return r;if(typeof r!="object")return"";if(Array.isArray(r))return t.apply(null,r);if(r.toString!==Object.prototype.toString&&!r.toString.toString().includes("[native code]"))return r.toString();var i="";for(var h in r)o.call(r,h)&&r[h]&&(i=d(i,h));return i}function d(r,i){return i?r?r+" "+i:r+i:r}e.exports?(t.default=t,e.exports=t):window.classNames=t})()})(_);var Y=_.exports;const P=M(Y),Z=["xxl","xl","lg","md","sm","xs"],z="xs",ee=y.createContext({prefixes:{},breakpoints:Z,minBreakpoint:z});function O(e,o){const{prefixes:t}=y.useContext(ee);return e||t[o]||o}const se=["as","disabled"];function te(e,o){if(e==null)return{};var t={},l=Object.keys(e),d,r;for(r=0;r<l.length;r++)d=l[r],!(o.indexOf(d)>=0)&&(t[d]=e[d]);return t}function ne(e){return!e||e.trim()==="#"}function k({tagName:e,disabled:o,href:t,target:l,rel:d,role:r,onClick:i,tabIndex:h=0,type:p}){e||(t!=null||l!=null||d!=null?e="a":e="button");const x={tagName:e};if(e==="button")return[{type:p||"button",disabled:o},x];const a=u=>{if((o||e==="a"&&ne(t))&&u.preventDefault(),o){u.stopPropagation();return}i==null||i(u)},v=u=>{u.key===" "&&(u.preventDefault(),a(u))};return e==="a"&&(t||(t="#"),o&&(t=void 0)),[{role:r??"button",disabled:void 0,tabIndex:o?void 0:h,href:t,target:e==="a"?l:void 0,"aria-disabled":o||void 0,rel:e==="a"?d:void 0,onClick:a,onKeyDown:v},x]}const re=y.forwardRef((e,o)=>{let{as:t,disabled:l}=e,d=te(e,se);const[r,{tagName:i}]=k(Object.assign({tagName:t,disabled:l},d));return s.jsx(i,Object.assign({},d,r,{ref:o}))});re.displayName="Button";const A=y.forwardRef(({as:e,bsPrefix:o,variant:t="primary",size:l,active:d=!1,disabled:r=!1,className:i,...h},p)=>{const x=O(o,"btn"),[a,{tagName:v}]=k({tagName:e,disabled:r,...h}),u=v;return s.jsx(u,{...a,...h,ref:p,disabled:r,className:P(i,x,d&&"active",t&&`${x}-${t}`,l&&`${x}-${l}`,h.href&&r&&"disabled")})});A.displayName="Button";const I=A;function ae(e,o){let t=0;return y.Children.map(e,l=>y.isValidElement(l)?o(l,t++):l)}const T=1e3;function ie(e,o,t){const l=(e-o)/(t-o)*100;return Math.round(l*T)/T}function D({min:e,now:o,max:t,label:l,visuallyHidden:d,striped:r,animated:i,className:h,style:p,variant:x,bsPrefix:a,...v},u){return s.jsx("div",{ref:u,...v,role:"progressbar",className:P(h,`${a}-bar`,{[`bg-${x}`]:x,[`${a}-bar-animated`]:i,[`${a}-bar-striped`]:i||r}),style:{width:`${ie(o,e,t)}%`,...p},"aria-valuenow":o,"aria-valuemin":e,"aria-valuemax":t,children:d?s.jsx("span",{className:"visually-hidden",children:l}):l})}const H=y.forwardRef(({isChild:e=!1,...o},t)=>{const l={min:0,max:100,animated:!1,visuallyHidden:!1,striped:!1,...o};if(l.bsPrefix=O(l.bsPrefix,"progress"),e)return D(l,t);const{min:d,now:r,max:i,label:h,visuallyHidden:p,striped:x,animated:a,bsPrefix:v,variant:u,className:g,children:C,...b}=l;return s.jsx("div",{ref:t,...b,className:P(g,v),children:C?ae(C,w=>y.cloneElement(w,{isChild:!0})):D({min:d,now:r,max:i,label:h,visuallyHidden:p,striped:x,animated:a,bsPrefix:v,variant:u},t)})});H.displayName="ProgressBar";const le=H;function me({course:e,learningProgress:o}){var E;const[t,l]=N.useState(null),[d,r]=N.useState(o),[i,h]=N.useState(0),[p,x]=N.useState(0),[a,v]=N.useState(0),u=N.useRef(null),g=N.useRef(null),C={autoplay:!0,controls:!0,responsive:!0,fluid:!0,html5:{hls:{withCredentials:!0}}};N.useEffect(()=>{if(t)if(!g.current&&t){const n=document.createElement("video-js");n.classList.add("vjs-big-play-centered"),u.current.appendChild(n);const c=g.current=L(n,C,()=>{L.log("player is ready"),onReady&&onReady(c)});c.src({src:"/video/"+t.id,type:"application/x-mpegURL",withCredentials:!0})}else g.current.src({src:"/video/"+t.id,type:"application/x-mpegURL",withCredentials:!0})},[C,u,t]),N.useEffect(()=>{const n=g.current;return()=>{n&&!n.isDisposed()&&(n.dispose(),g.current=null)}},[g]);const b=(n,c,m,j)=>{if(!n)return;h(j),x(m),v(c),l(n);const f=g.current;d[n.id]={status:"started",progress:0},f.src({src:"/video/"+n.id,type:"application/x-mpegURL",withCredentials:!0}),d[n.id]},w=(n,c,m,j,f,$)=>{d[n.id]={status:c,progress:m},r({...d}),Q.post(route("update-progress"),{course_lesson_id:n.id,course_id:e.id,status:c,progress:m}).then(B=>{c=="completed"&&U()})},S=()=>{let n=0,c=0;return e.sections.forEach(m=>{m.chapters.forEach(j=>{j.lessons.forEach(f=>{c++,d[f.id]&&d[f.id].status=="completed"&&n++})})}),Math.round(n/c*100)},K=()=>{let n=null,c=i,m=p,j=a;i>0?(n=e.sections[a].chapters[p].lessons[i-1],c=i-1):p>0?(n=e.sections[a].chapters[p-1].lessons[e.sections[a].chapters[p-1].lessons.length-1],m=p-1,c=e.sections[a].chapters[p-1].lessons.length-1):a>0?(n=e.sections[a-1].chapters[e.sections[a-1].chapters.length-1].lessons[e.sections[a-1].chapters[e.sections[a-1].chapters.length-1].lessons.length-1],j=a-1,m=e.sections[a-1].chapters.length-1,c=e.sections[a-1].chapters[e.sections[a-1].chapters.length-1].lessons.length-1):n=null,l(n),n?b(n,j,m,c):l(null)},U=()=>{let n=null,c=i,m=p,j=a;e.sections[a].chapters[p].lessons.length>i+1&&e.sections[a].chapters[p].lessons[i+1]?(n=e.sections[a].chapters[p].lessons[i+1],c=i+1):e.sections[a].chapters.length>p+1&&e.sections[a].chapters[p+1].lessons.length>0?(n=e.sections[a].chapters[p+1].lessons[0],m=p+1,c=0):e.sections.length>a+1&&e.sections[a+1].chapters.length>0&&e.sections[a+1].chapters[0].lessons.length>0?(n=e.sections[a+1].chapters[0].lessons[0],j=a+1,m=0,c=0):n=null,l(n),n&&b(n,j,m,c)};return s.jsxs(X,{children:[s.jsx(F,{title:"Dashboard"}),s.jsx("header",{className:"learning-header",children:s.jsxs("div",{className:"row",children:[s.jsxs(V,{href:route("enrolled-course"),className:"col-md-3 header-left",children:[s.jsx("i",{className:"feather-arrow-left"})," Quay lại trang chủ"]}),s.jsx("div",{className:"col-md-9 text-end",children:s.jsxs("div",{className:"lesson-nav",children:[s.jsxs(I,{variant:"outline-light",disabled:!t,onClick:()=>{K()},children:[s.jsx("i",{className:"feather-arrow-left"})," Bài trước"]}),s.jsxs(I,{variant:"success",disabled:!t,onClick:()=>{w(t,"completed",100)},children:["Hoàn thành và tiếp tục ",s.jsx("i",{className:"feather-arrow-right"})]})]})})]})}),s.jsxs("div",{className:"row",children:[s.jsxs("div",{className:"col-md-3 bottom-left",children:[s.jsxs("div",{className:"course-name",children:[s.jsxs("strong",{children:["Khóa học: ",e.name]}),s.jsx(le,{now:S(),className:"course-progress-bar"}),s.jsxs("div",{className:"course-progress",children:["Hoàn thành: ",S(),"%"]})]}),s.jsx("div",{className:"course-lesson-list rbt-course-feature-inner",children:s.jsx("div",{className:"rbt-accordion-style rbt-accordion-02 accordion",children:s.jsx("div",{className:"accordion",id:"accordionExampleb2",children:e.sections&&((E=e.sections)==null?void 0:E.map((n,c)=>s.jsxs("div",{className:"accordion-item card",children:[s.jsx("h2",{className:"accordion-header card-header",id:`headingTwo${c}`,children:s.jsxs("button",{className:`accordion-button ${n.collapsed?"":"collapsed"}`,type:"button","data-bs-toggle":"collapse","data-bs-target":`#collapseTwo${c+1}`,"aria-controls":`collapseTwo${c+1}`,children:[n.name,s.jsxs("span",{className:"rbt-badge-5 ml--10",children:[n.duration," phút"]})]})}),s.jsx("div",{id:`collapseTwo${c+1}`,className:"accordion-collapse collapse show","aria-labelledby":`headingTwo${c}`,children:s.jsx("div",{className:"accordion-body card-body pr--0",children:s.jsx("ul",{className:"rbt-course-main-content liststyle",children:n.chapters.map((m,j)=>s.jsxs("li",{children:[s.jsx("h6",{className:"mt-5 mb-4 text-uppercase text-bold",children:m.name}),m.lessons.map((f,$)=>s.jsx("li",{children:s.jsx("a",{href:"#",onClick:B=>{B.preventDefault(),b(f,c,c,$)},children:s.jsxs("div",{className:"course-content-left",children:[t&&(t==null?void 0:t.id)==(f==null?void 0:f.id)?s.jsx("i",{className:"lesson-icon feather-play-circle"}):d[f.id]?d[f.id].status=="completed"?s.jsx("i",{className:"lesson-icon feather-check-circle"}):s.jsx("i",{className:"lesson-icon feather-pause-circle"}):s.jsx("i",{className:"lesson-icon feather-circle"}),s.jsxs("span",{className:"text",children:[f.name," (",J(f.duration),")"]})]})})},j))]}))})})})]},c)))})})})]}),s.jsx("div",{className:"col-md-9 lesson-outer-container",children:s.jsx("div",{className:"lesson-container",children:t?s.jsxs("div",{children:[s.jsx("h3",{className:"lesson-title",children:t==null?void 0:t.name}),s.jsx("div",{className:"mt-5",children:s.jsx("div",{"data-vjs-player":"",children:s.jsx("div",{ref:u})})}),s.jsxs("div",{className:"lesson-content",children:[s.jsx("p",{className:"lesson-description",dangerouslySetInnerHTML:{__html:t==null?void 0:t.description}}),s.jsx("div",{className:"lesson-action",children:s.jsx(R,{onClick:n=>{n.preventDefault(),w(t,"completed",100)},children:"Hoàn thành bài học"})})]})]}):s.jsxs("div",{children:[s.jsx("h3",{className:"lesson-title",children:e==null?void 0:e.name}),s.jsx("p",{className:"lesson-description",dangerouslySetInnerHTML:{__html:e==null?void 0:e.description}}),s.jsx("div",{className:"lesson-action",children:s.jsx(R,{onClick:n=>{n.preventDefault(),b(e.sections[0].chapters[0].lessons[0],0,0,0)},children:"Bắt đầu học"})})]})})})]}),s.jsx("div",{children:s.jsx("div",{})})]})}export{me as default};
